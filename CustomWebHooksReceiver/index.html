<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My ASP.NET Application</title>
    <link href="Content/bootstrap.css" rel="stylesheet" />
    <link href="Content/Site.css" rel="stylesheet" />
    <script src="Scripts/jquery-1.10.2.min.js"></script>
    <script src="Scripts/bootstrap.min.js"></script>
    <script src="Scripts/datatables.min.js"></script>
</head>
<body>
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><h3 style="color: #fff;">Portal Sancor</h3></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="container body-content">
        <br/>
        <div class="row">
            <button type="button" class="btn btn-success btn-lg" id="InscreverSe">Inscrever-se</button>
            <button type="button" class="btn btn-danger btn-lg" id="CancelarInscricao">Cancelar Inscrição</button>
        </div>
        <br/>
        <div class="row">
            <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%"></table>
        </div>
        <footer>
            <p>My ASP.NET Application</p>
        </footer>
    </div>
</body>
</html>
<script>
    var tabela = $("#example").dataTable({
        "sDom": "t<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>",
        "autoWidth": true,
        "iDisplayLength": 10,
        "aaData": [],
        "aoColumns": [
            { "sTitle": "ID", "mData": "Id", "sWidth": "10%" },
            { "sTitle": "Nome", "mData": "Nome", "sWidth": "40%" },
            { "sTitle": "Sobrenome", "mData": "Sobrenome", "sWidth": "30%" },
            { "sTitle": "CPF", "mData": "CPF", "sWidth": "20%" }
        ],
        "aaSorting": [],
        "oLanguage": {
            "sInfo": "_START_ a _END_ em _TOTAL_ " + "Clientes",
            "sInfoEmpty": "",
            "sEmptyTable": "Não clientes cadastrados",
            "sInfoFiltered": "",
            "sZeroRecords": "Não há registros para o filtro informado",
            "oPaginate": {
                "sFirst": "<<",
                "sLast": ">>",
                "sPrevious": "<",
                "sNext": ">"
            }
        }
    });

    $("#InscreverSe").on("click", function() {
        $.ajax({
            type: "POST",
            url: "/api/Registros/InscreverSe",
            data: JSON.stringify({
                WebHookUri: "http://localhost:53890/api/webhooks/incoming/custom",
                Secret: "12345678901234567890123456789012",
                Description: "Inscrição I4Pro",
                Filters: ["CriarCliente", "EditarCliente", "ExcluirCliente"]
            }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function () {
                alert("Inscrição realizada");
            },
            error: function (ex) {
                alert(ex.statusText);
            }
        });
    });

    $("#CancelarInscricao").on("click", function () {
        $.ajax({
            url: "/api/Registros/CancelarInscricao",
            type: "DELETE",
            traditional: true
        }).success(function () {
            alert("Inscrição cancelada");
        }).error(function (ex) {
            alert(ex.statusText);
        });
    });

    $.ajax({
        url: "/api/Cliente/PesquisarCliente",
        type: "GET",
        traditional: true
    }).success(function (data) {
        if (data.length) {
            tabela.fnAddData(data);
        }
    }).error(function (ex) {
        alert(ex.statusText);
    });
</script>